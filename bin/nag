#! /usr/bin/env coffee
Nag            = require("../index")
OptionsBuilder = require("../lib/optionsBuilder")
C              = require("../lib/constants")
HelpHelper     = require("../lib/helpHelper")
options        = OptionsBuilder.build()

switch options.command

  when C.COMMANDS.QUIZ
    unless options.ignore
      new Nag({
        interactive: true
        opts: options
      })

  when C.COMMANDS.EDIT
    spawn  = require('child_process').spawn
    editor = process.env.EDITOR || C.DEFAULTS.EDITOR
    child  = spawn(editor, [C.PATHS.QUESTIONS], { stdio: 'inherit' })
    child.on('exit', (e, code) ->)

  when C.COMMANDS.CONFIG
    spawn  = require('child_process').spawn
    editor = process.env.EDITOR || C.DEFAULTS.EDITOR
    child  = spawn(editor, [C.PATHS.CONFIG], { stdio: 'inherit' })
    child.on('exit', (e, code) ->)

  else
    helpHelper = new HelpHelper(options.command)
    if helpHelper.isHelp
      spawn   = require('child_process').spawn
      command = if helpHelper.isQuick then 'cat' else 'man'
      if helpHelper.fileExists()
        child   = spawn(command, [helpHelper.path()], { stdio: 'inherit' })
        child.on('exit', (e, code) ->)
      else
        console.log "No results for \"#{helpHelper.search}\""
